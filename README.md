# Data Mining Project COMP 406 - Zoha Hassan and Fiona Nicdao
## Notes for our code: 
Stage3_DataMiningProject.ipynb and Stage3_DataMiningProject.py are the same file, just different extension, for whatever works best for your machine. 
Here is the link to the google colab: https://colab.research.google.com/drive/1_Juz-5R0GFC4k8vTD6K7qL3OjgmJkeyl?usp=sharing 
Here is the link to the Github: 
https://github.com/fiona1nicdao/DataMiningProject/tree/main 
## Loading datasets and preprocessing
So to recap, our project is looking at how different factors affect one’s sleep. We use four datasets that look at sleep efficiency, lifestyle, productivity, and effect on sleep deprivation.
### Removing underage "samples"
 From our initial investigation, we chose to remove underage people, or “samples”, from the dataset because there were so few of them (only one dataset had underage samples) and to focus on how sleep affects adults. 
### Dataset Shape Analysis
Then looking at the shape of the datasets we found “sleep_cycle_productivity.csv”  (df_cycle) has 5000 samples with 15 attributes, while the rest of the datasets have less than 600 samples combined with similar attributes. So our focus is on the df_cycle dataset because it has over 1000 samples and is the largest dataset of all the datasets. 
## Creating a combined dataset with all four datasets
Our next step is combining the four datasets into one big dataframe called df_age which looks at age, gender, and sleep duration since those are the common attributes across all datasets. We have a total of 5594 samples in the combined data frame df_age. 
### Creating Age Group Attribute
We also added another attribute called “Age Group” by putting each sample in an age group to find similarities or differences between them. 
## Analysis of Combined Data Frame df_age
So looking at the histogram of the combined data frame we can see the age distribution that the majority of the samples are from 18 - 65 years old, so people at working age with only 15 samples from 65 and above, people close to or at retirement age. Then looking at the age distribution from each dataset we can see the 15 samples only come from the “sleep_efficiency_dataset.csv”. Then looking at the distribution of gender in the combined data frame there is a similar size of male to female and a smaller number of people who categorize themselves as other but a significant amount of people in the other group. When we look at the distribution of gender from each dataset we see that only “sleep_cycle_productivity.csv” has the other group. Then looking at the box plot for the duration of sleep for each age group we see this trend that the spread of sleep duration decreases as you increase in age group, such as for the 18-24 age group sleep duration is from 3 hours to about 9.5hours while the 65 - 100 age group is 6 to 9 hours of sleep. 
## Dataset: Sleep Cycle Productivity
From this dataset “sleep_cycle_productivity.csv”  (df_cycle) we see that there is no significant difference between age groups in any of the categories, sleep duration, sleep quality, exercise, etc. The only difference is in the last age group 65-100, however there are only 15 samples in that age group so the data may be skewed from the small sample size. So this section will be removed from the final stage of the project because it does not give any significant results. 

## Caffeine Dataset
Two of the questions that we wanted to explore was if caffeine affects one gender more than the others, and if there is a certain caffeine threshold that prevents sleeping duration. To answer these questions, we created a caffeine dataset called df_caffeine by merging the attributes age, gender, sleep duration, and caffeine intake from the datasets sleep efficiency and sleep cycle and dropping the samples with null values. We plotted two separate scatterplots, one to see caffeine impacts sleep duration by gender and one to see how caffeine impacts females in the “young” age group of 18-25. These resulted in undecipherable scatterplots, so we moved on to creating box plots for caffeine consumption and sleep duration by gender. The boxplots showed that these values were more or less equal per gender. So we discovered that gender is not a good separator for caffeine and sleep duration and decided to forgo those research questions.
## Occupation and Sleep Duration
One of our datasets, Sleep Health and Lifestyle included an attribute for the occupation of each sample. We wanted to take a look at the top 5 most popular occupations and graph their sleep duration to see if we could gain any insights there. We found that the top five occupations were nurse, teacher, salesperson, doctor, and accountant. With that information, we created a new dataframe called df_top_occupations that filtered out those rows from the original dataset, and plotted a barplot of the average sleep duration of each occupation, as well as a boxplot to get more insight on this relationship. The conclusions we extracted from these are that salespersons and nurses experience the least sleep duration based on the sleep duration medians of those occupations. Following that, teachers and accountants, and then doctors have the highest median sleep durations. However, nurses, have the highest range of sleep duration, from 6.2-8.1 hours.
## Exploring relationships between BMI category, Sleep Duration, and Sleep Disorders
Another area we wanted to explore was BMI category and sleep disorders impact on sleep duration. Continuing to take a look at the Sleep Health and Lifestyle dataset, we began by listing all the unique categorical values in BMI category and Sleep Disorders. We found that sleep apnea and insomnia are the two sleep disorders in the dataset, and the categories for BMI are normal, normal weight, overweight, and obese. We decided to drop the normal weight category since it was only 4 rows, and repetitive since we already had the normal category as well. Then we created boxplots for BMI category vs sleep duration and for sleep disorders vs sleep duration. The findings were that those with a normal BMI and obese BMI have similar medians for sleep duration, but those with normal BMIs have a much smaller range of about 7.3-7.6 hours. The range for sleep duration of obese BMI is about 6.0-7.4 hours of sleep. For the overweight BMI, the median sleep duration is 6.5, and the range is 6.4-6.6 hours of sleep. However, this group also has many outliers that indicate that there are a few overweight people that get around 8 hours of sleep. For sleep disorders, as expected those with insomnia sleep much less than those with sleep apnea. The insomnia group’s median sleep duration is 6.5 hours, and the range is 6.4-6.6 hours of sleep. There are many outliers with this group, however, with many people sleeping more than these values and many sleeping even less. The sleep apnea group’s median sleep duration is 6.9 hours, but the range is very large from 6.1-8.1 hours of sleep. So, it seems like sleep duration might be independent of sleep apnea.
### PCA
PCA analysis is still a work in progress but something we would like to implement in the final stage of the project. 

# Next Steps
We plan to implement at least one: PCA, tSNE, or UMAP to our data. We plan to analyze the other dataset sleep deprivation  and sleep efficiency to answer our questions. We plan to finalize our plots to be more appealing to the audience with large fonts, different colors, etc. 
